# システムアーキテクチャ

## 概要

BAYSGAiA現金残高最大化システムは、モノレポ構成のフルスタックWebアプリケーションです。

## アーキテクチャ図

```
┌─────────────────────────────────────────────────────────────┐
│                         クライアント層                          │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │
│  │   React     │  │  TypeScript │  │ TailwindCSS │      │
│  │  + Vite     │  │             │  │  Chart.js   │      │
│  └─────────────┘  └─────────────┘  └─────────────┘      │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                          API層                               │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │
│  │  Express.js │  │ TypeScript  │  │   RESTful   │      │
│  │             │  │             │  │     API     │      │
│  └─────────────┘  └─────────────┘  └─────────────┘      │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                       サービス層                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │
│  │    Bank     │  │     AI      │  │  Workflow   │      │
│  │  Service    │  │  Service    │  │  Service    │      │
│  └─────────────┘  └─────────────┘  └─────────────┘      │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                        外部連携                               │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │
│  │GMOあおぞら  │  │  OpenAI     │  │   その他    │      │
│  │ 銀行API     │  │    API      │  │    API      │      │
│  └─────────────┘  └─────────────┘  └─────────────┘      │
└─────────────────────────────────────────────────────────────┘
```

## 技術スタック詳細

### フロントエンド

#### React + TypeScript
- **バージョン**: React 18.3.1
- **状態管理**: @tanstack/react-query
- **ルーティング**: React Router v6

#### ビルドツール
- **Vite**: 高速な開発サーバーとビルド
- **設定**: `vite.config.ts`

#### スタイリング
- **TailwindCSS**: ユーティリティファーストCSS
- **Chart.js**: データビジュアライゼーション

### バックエンド

#### Node.js + Express
- **バージョン**: Node.js 18+
- **フレームワーク**: Express 4.x
- **言語**: TypeScript

#### APIアーキテクチャ
```
src/
├── controllers/    # リクエストハンドリング
├── services/       # ビジネスロジック
├── models/         # データモデル
├── routes/         # ルーティング定義
├── middleware/     # 認証、エラーハンドリング
└── utils/          # ユーティリティ関数
```

### 外部API連携

#### GMOあおぞらネット銀行API
- **認証**: OAuth 2.0
- **通信**: HTTPS (TLS 1.2+)
- **主要エンドポイント**:
  - 残高照会
  - 入出金明細
  - 振込実行

## セキュリティアーキテクチャ

### 認証・認可
- JWT (JSON Web Token) ベース認証
- Role-Based Access Control (RBAC)
- セッション管理

### データ保護
- HTTPS通信の強制
- データベース暗号化
- APIレート制限

### 監査
- 全APIアクセスログ
- 重要操作の監査証跡
- 定期的なセキュリティスキャン

## デプロイメントアーキテクチャ

### 開発環境
```bash
# ローカル開発
npm run dev

# Docker開発環境
docker-compose up -d
```

### 本番環境
- **ホスティング**: AWS / Azure / GCP
- **CI/CD**: GitHub Actions
- **監視**: DataDog / CloudWatch

## パフォーマンス最適化

### フロントエンド
- コード分割 (Code Splitting)
- 遅延読み込み (Lazy Loading)
- キャッシュ戦略

### バックエンド
- データベースクエリ最適化
- Redis キャッシング
- 非同期処理

## スケーラビリティ

### 水平スケーリング
- ロードバランサー設定
- ステートレスアーキテクチャ
- マイクロサービス対応準備

### 垂直スケーリング
- リソース監視
- 自動スケーリング設定

## 開発ガイドライン

### コーディング規約
- ESLint + Prettier設定
- TypeScript strict mode
- コンポーネント設計原則

### テスト戦略
- 単体テスト: Jest
- 統合テスト: Supertest
- E2Eテスト: Cypress

### ドキュメント
- JSDoc コメント
- API仕様: OpenAPI 3.0
- アーキテクチャ決定記録 (ADR)